(self.webpackChunksrcAngular=self.webpackChunksrcAngular||[]).push([[8592],{14525:(R,m,s)=>{"use strict";s.d(m,{H:()=>n});var d=s(1694);class n{constructor(o,u){this.route=o,this.tr=u,this.title="",this.initTitle()}initTitle(){this.route.snapshot.params.cusfunc?this.title=this.tr.transform(this.route.snapshot.params.cusfunc.toUpperCase()):this.route.data.subscribe(o=>{o.id&&(this.title=this.tr.transform(o.id.toUpperCase()))})}getControls(o,u){return o.controls[u].controls}compare(o,u,e){return(o<u?-1:1)*(e?1:-1)}addFormValidator(o,u){try{u.map(e=>{let l=new Array;e.isRequired&&(l.push(d.lL(e.isRequired.msg)),$(`#${e.field}_label`).addClass("required")),e.maxLength&&l.push(d.dH(e.maxLength.value,e.maxLength.msg)),e.max&&l.push(d.sc(e.type,e.max.value,e.max.msg)),e.minLength&&l.push(d.OP(e.minLength.value,e.minLength.msg)),e.min&&l.push(d.R1(e.type,e.min.value,e.min.msg)),e.pattern&&l.push(d.FW(e.pattern.value,e.pattern.msg)),o.controls[e.field].setValidators(l),o.controls[e.field].updateValueAndValidity()})}catch(e){this.resetFormValidator(o)}}resetFormValidator(o,u=!0){for(const e in o.controls)$(`#${e}_label`).removeClass("required"),u&&o.controls[e].reset(""),o.controls[e].clearValidators(),o.controls[e].updateValueAndValidity()}}},58838:(R,m,s)=>{"use strict";s.d(m,{n:()=>h});var d=s(27896),n=s(92340),p=s(57553),o=s(95244),e=s(87587),l=s(22313),r=s(4516),a=s(86518),t=s(69808);function c(g,P){if(1&g&&e._UZ(0,"iframe",1),2&g){const i=e.oxw();e.Q6J("src",i.url,e.uOi)}}const E=s(35117);let h=(()=>{class g{constructor(i,_,f,y){this.sanitizer=i,this.util=_,this.tool=f,this.alertService=y,this.reportID="",this.url="",this.timeRange=p.tn.Today,this.showStatus=!1,this.msgListenterAdd=!1,this.processing=!1,this.messageHandler=this.createMessageHandler()}ngOnInit(){this.showStatus=!1,this.url=this.sanitizer.bypassSecurityTrustResourceUrl(""),this.search(),window.addEventListener("message",this.messageHandler)}ngOnDestroy(){window.removeEventListener("message",this.messageHandler)}createMessageHandler(){return i=>{var _,f,y,v;"frame"==(null===(_=i.data)||void 0===_?void 0:_.from)&&"token_expired"==(null===(f=i.data)||void 0===f?void 0:f.type)?this.processing||(this.processing=!0,this.util.queryReportUrls({reportID:this.reportID.toUpperCase(),timeRange:"T"}).subscribe(A=>{var B;this.processing=!1,this.tool.checkDpSuccess(A.ResHeader)&&(null===(B=document.getElementById("_frame").contentWindow)||void 0===B||B.postMessage({from:"dgr",type:"redo"},"*"))})):"frame"==(null===(y=i.data)||void 0===y?void 0:y.from)&&"reset_idle_time"==(null===(v=i.data)||void 0===v?void 0:v.type)&&this.tool.setExpiredTime()}}search(i=!1){let _=this.generateCAPI();this.timeRange&&this.util.queryReportUrls({reportID:this.reportID.toUpperCase(),timeRange:"T"}).subscribe(f=>{if(this.tool.checkDpSuccess(f.ResHeader)){if(this.showStatus=!0,i)return;let y="";y="localhost"==location.hostname||"127.0.0.1"==location.hostname?n.N.apiUrl:`${location.protocol}//${location.hostname}:${location.port}`;let v="";switch(f.RespBody.reportType){case"SYS_RPT":v=`${y}${f.RespBody.rpContentPath}/login?cuuid=${_.uuid}&capikey=${_.capi}&reportURL=${f.RespBody.reportUrl}&embed=true`,this.url=this.sanitizer.bypassSecurityTrustResourceUrl(v);break;case"IFRAME":v=n.N.production?`${location.protocol}//${location.hostname}:${location.port}${f.RespBody.reportUrl}`:`${n.N.cusHostName}${f.RespBody.reportUrl}`,this.url=this.sanitizer.bypassSecurityTrustResourceUrl(v);break;case"LINK":v=`${f.RespBody.reportUrl}`,window.open(v,"_blank");break;default:this.alertService.ok("reportType not found","")}}})}generate_uuid(){var i=Date.now();return"undefined"!=typeof performance&&"function"==typeof performance.now&&(i+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(_){var f=(i+16*Math.random())%16|0;return i=Math.floor(i/16),("x"===_?f:3&f|8).toString(16)})}generateCAPI(){let i=this.generate_uuid().toUpperCase(),_=this.encodeUUID(i);return"Error: Digest method not supported"===_&&(i="67C42D24-BCFD-40B1-99E9-C4CE4D9ADBCD",_="tflvB2FW3nhUIvF3PMHQxw"),{uuid:i,capi:_}}encodeUUID(i){if("string"!=typeof i||0===i.length)return"";const f=Uint8Array.of(128),y=new TextEncoder;try{let v=i.toLocaleUpperCase()+"TPIdigiRunner",A=y.encode(v),B=this.concatenate(Uint8Array,A,f),D=o("sha256").update(B).digest(),x=D.subarray(D.length/2,D.length);return E(x)}catch(v){return console.log("e",v),v}}concatenate(i,..._){let f=0;for(const A of _)f+=A.length;const y=new i(f);let v=0;for(const A of _)y.set(A,v),v+=A.length;return y}}return g.\u0275fac=function(i){return new(i||g)(e.Y36(l.H7),e.Y36(d.f),e.Y36(r.g),e.Y36(a.c))},g.\u0275cmp=e.Xpm({type:g,selectors:[["app-frame"]],inputs:{reportID:"reportID"},features:[e._Bn([d.f])],decls:1,vars:1,consts:[["id","_frame","title","","width","100%","height","100%","frameborder","0",3,"src",4,"ngIf"],["id","_frame","title","","width","100%","height","100%","frameborder","0",3,"src"]],template:function(i,_){1&i&&e.YNc(0,c,1,1,"iframe",0),2&i&&e.Q6J("ngIf",_.showStatus)},directives:[t.O5],styles:[""]}),g})()},85118:(R,m,s)=>{"use strict";s.d(m,{U:()=>u});var d=s(92340),n=s(57553),p=s(87587),o=s(96614);let u=(()=>{class e{constructor(r){this.api=r}get npBasePath(){return d.N.isv4?"dgrv4/11":"tsmpdpaa/11"}addAlarmSettings_before(){let r={ReqHeader:this.api.getReqHeader(n.Nx.addAlarmSettings),ReqBody:{}};return this.api.npPost(`${this.npBasePath}/AA0701?before`,r)}addAlarmSettings(r){let a={ReqHeader:this.api.getReqHeader(n.Nx.addAlarmSettings),ReqBody:r};return this.api.npPost(`${this.npBasePath}/AA0701`,a)}queryAlertSettingDetail(r){let a={ReqHeader:this.api.getReqHeader(n.Nx.queryAlertSettingDetail),ReqBody:r};return this.api.npPost(`${this.npBasePath}/AA0703`,a)}updateAlertSetting_before(){let r={ReqHeader:this.api.getReqHeader(n.Nx.updateAlertSetting),ReqBody:{}};return this.api.npPost(`${this.npBasePath}/AA0704?before`,r)}updateAlertSetting(r){let a={ReqHeader:this.api.getReqHeader(n.Nx.updateAlertSetting),ReqBody:r};return this.api.npPost(`${this.npBasePath}/AA0704`,a)}deleteAlertSetting(r){let a={ReqHeader:this.api.getReqHeader(n.Nx.deleteAlert),ReqBody:r};return this.api.npPost(`${this.npBasePath}/AA0705`,a)}queryAlarmSettings_ignore1298(r){let a={ReqHeader:this.api.getReqHeader(n.Nx.queryAlarmSettings),ReqBody:r};return this.api.excuteNpPost_ignore1298(`${this.npBasePath}/AA0706`,a)}queryAlarmSettings(r){let a={ReqHeader:this.api.getReqHeader(n.Nx.queryAlarmSettings),ReqBody:r};return this.api.npPost(`${this.npBasePath}/AA0706`,a)}}return e.\u0275fac=function(r){return new(r||e)(p.LFG(o.K))},e.\u0275prov=p.Yz7({token:e,factory:e.\u0275fac}),e})()},78215:(R,m,s)=>{"use strict";s.d(m,{h:()=>u});var d=s(92340),n=s(57553),p=s(87587),o=s(96614);let u=(()=>{class e{constructor(r){this.api=r,this.api.baseUrl=d.N.dpPath}get basePath(){return d.N.isv4?"dgrv4/11":"tsmpdpaa/11"}signReq(r){let a={ReqHeader:this.api.getReqHeader(n.Nx.signReq),ReqBody:r};return this.api.npPost(`${this.basePath}/DPB0071`,a)}queryApiDpStatusLikeList_ignore1298(r){let a={ReqHeader:this.api.getReqHeader(n.Nx.queryApiDpStatusLikeList),ReqBody:r};return this.api.excuteNpPost_ignore1298(`${this.basePath}/DPB0072`,a)}queryApiDpStatusLikeList(r){let a={ReqHeader:this.api.getReqHeader(n.Nx.queryApiDpStatusLikeList),ReqBody:r};return this.api.npPost(`${this.basePath}/DPB0072`,a)}setApiPublicFlag(r){let a={ReqHeader:this.api.getReqHeader(n.Nx.setApiPublicFlag),ReqBody:r};return this.api.npPost(`${this.basePath}/DPB0073`,a)}}return e.\u0275fac=function(r){return new(r||e)(p.LFG(o.K))},e.\u0275prov=p.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},75809:(R,m,s)=>{"use strict";s.d(m,{A:()=>u});var d=s(92340),n=s(57553),p=s(87587),o=s(96614);let u=(()=>{class e{constructor(r){this.api=r,this.api.baseUrl=d.N.dpPath}get basePath(){return d.N.isv4?"dgrv4/11":"tsmpdpaa/11"}queryApiLov_ignore1298(r){let a={ReqHeader:this.api.getReqHeader(n.Nx.queryApiLov),ReqBody:r};return this.api.excuteNpPost_ignore1298(`${this.basePath}/DPB0075`,a)}queryApiLov(r){let a={ReqHeader:this.api.getReqHeader(n.Nx.queryApiLov),ReqBody:r};return this.api.npPost(`${this.basePath}/DPB0075`,a)}queryThemeLov_ignore1298(r){let a={ReqHeader:this.api.getReqHeader(n.Nx.queryThemeLov),ReqBody:r};return this.api.excuteNpPost_ignore1298(`${this.basePath}/DPB0076`,a)}queryThemeLov(r){let a={ReqHeader:this.api.getReqHeader(n.Nx.queryThemeLov),ReqBody:r};return this.api.npPost(`${this.basePath}/DPB0076`,a)}}return e.\u0275fac=function(r){return new(r||e)(p.LFG(o.K))},e.\u0275prov=p.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},51753:(R,m,s)=>{"use strict";s.d(m,{Y:()=>n});var d=s(87587);let n=(()=>{class p{constructor(){}navigateUrl(u){window.location.href=u}}return p.\u0275fac=function(u){return new(u||p)},p.\u0275prov=d.Yz7({token:p,factory:p.\u0275fac}),p})()},79581:(R,m,s)=>{"use strict";var n=s(8708);function p(a,t){return void 0===t&&(t="utf8"),Buffer.isBuffer(a)?e(a.toString("base64")):e(Buffer.from(a,t).toString("base64"))}function u(a){return a=a.toString(),n.default(a).replace(/\-/g,"+").replace(/_/g,"/")}function e(a){return a.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}var r=p;r.encode=p,r.decode=function o(a,t){return void 0===t&&(t="utf8"),Buffer.from(u(a),"base64").toString(t)},r.toBase64=u,r.fromBase64=e,r.toBuffer=function l(a){return Buffer.from(u(a),"base64")},m.default=r},8708:(R,m)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0}),m.default=function s(d){var p=d.length,o=p%4;if(!o)return d;var u=p,e=4-o,r=Buffer.alloc(p+e);for(r.write(d);e--;)r.write("=",u++);return r.toString()}},35117:(R,m,s)=>{R.exports=s(79581).default,R.exports.default=R.exports},94327:function(R,m){var n;void 0!==(n=function(){"use strict";function o(t,c,E){var h=new XMLHttpRequest;h.open("GET",t),h.responseType="blob",h.onload=function(){a(h.response,c,E)},h.onerror=function(){console.error("could not download file")},h.send()}function u(t){var c=new XMLHttpRequest;c.open("HEAD",t,!1);try{c.send()}catch(E){}return 200<=c.status&&299>=c.status}function e(t){try{t.dispatchEvent(new MouseEvent("click"))}catch(E){var c=document.createEvent("MouseEvents");c.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(c)}}var l="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,r=l.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),a=l.saveAs||("object"!=typeof window||window!==l?function(){}:"download"in HTMLAnchorElement.prototype&&!r?function(t,c,E){var h=l.URL||l.webkitURL,g=document.createElement("a");g.download=c=c||t.name||"download",g.rel="noopener","string"==typeof t?(g.href=t,g.origin===location.origin?e(g):u(g.href)?o(t,c,E):e(g,g.target="_blank")):(g.href=h.createObjectURL(t),setTimeout(function(){h.revokeObjectURL(g.href)},4e4),setTimeout(function(){e(g)},0))}:"msSaveOrOpenBlob"in navigator?function(t,c,E){if(c=c||t.name||"download","string"!=typeof t)navigator.msSaveOrOpenBlob(function p(t,c){return void 0===c?c={autoBom:!1}:"object"!=typeof c&&(console.warn("Deprecated: Expected third argument to be a object"),c={autoBom:!c}),c.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob(["\ufeff",t],{type:t.type}):t}(t,E),c);else if(u(t))o(t,c,E);else{var h=document.createElement("a");h.href=t,h.target="_blank",setTimeout(function(){e(h)})}}:function(t,c,E,h){if((h=h||open("","_blank"))&&(h.document.title=h.document.body.innerText="downloading..."),"string"==typeof t)return o(t,c,E);var g="application/octet-stream"===t.type,P=/constructor/i.test(l.HTMLElement)||l.safari,i=/CriOS\/[\d]+/.test(navigator.userAgent);if((i||g&&P||r)&&"undefined"!=typeof FileReader){var _=new FileReader;_.onloadend=function(){var v=_.result;v=i?v:v.replace(/^data:[^;]*;/,"data:attachment/file;"),h?h.location.href=v:location=v,h=null},_.readAsDataURL(t)}else{var f=l.URL||l.webkitURL,y=f.createObjectURL(t);h?h.location=y:location.href=y,h=null,setTimeout(function(){f.revokeObjectURL(y)},4e4)}});l.saveAs=a.saveAs=a,R.exports=a}.apply(m,[]))&&(R.exports=n)}}]);