"use strict";(self.webpackChunksrcAngular=self.webpackChunksrcAngular||[]).push([[6912],{86912:(A,g,s)=>{s.r(g),s.d(g,{LdapModule:()=>P});var f=s(31890),r=s(93075),L=s(69808),p=s(51753),v=s(92340),l=s(40520),Z=s(68306),e=s(87587),S=s(4516),U=s(86518),T=s(4924),b=s(27896),C=s(24300),y=s(99291),x=s(38441),Y=s(55679),M=s(72129),B=s(51062);const F=[{path:"",component:(()=>{class n{constructor(t,o,a,i,c,u,h,d,R,$,j,J){this.fb=t,this.httpClient=o,this.toolService=a,this.alertService=i,this.signBlockService=c,this.util=u,this.userService=h,this.router=d,this.ngxService=R,this.funcService=$,this.route=j,this.sanitizerService=J,this.title="",this.imgSrc="",this.idpType="LDAP"}ngOnInit(){this.form=this.fb.group({uname:new r.NI(""),mima:new r.NI("")}),this.route.queryParams.subscribe(t=>{t.type&&(this.idpType=t.type),this.getTitle(),this.getIcon()})}getTitle(){let t="";t="localhost"==location.hostname||"127.0.0.1"==location.hostname?v.N.apiUrl:`${location.protocol}//${location.hostname}:${location.port}`,t+=`/dgrv4/ssotoken/acidp/${this.idpType}/getTitle`;let o=new l.WM;this.httpClient.get(`${t}`,{headers:o,observe:"response",responseType:"text"}).subscribe(a=>{var i;this.title=null!==(i=a.body)&&void 0!==i?i:""})}getIcon(){let t="";t="localhost"==location.hostname||"127.0.0.1"==location.hostname?v.N.apiUrl:`${location.protocol}//${location.hostname}:${location.port}`,t+=`/dgrv4/ssotoken/acidp/${this.idpType}/getIcon`;let o=new l.WM;this.httpClient.get(`${t}`,{headers:o,observe:"response",responseType:"text"}).subscribe(a=>{var i;this.imgSrc=null!==(i=a.body)&&void 0!==i?i:""})}submitForm(){var t,o;let a=new URLSearchParams,i=new l.WM({"Content-Type":"application/x-www-form-urlencoded",digiRunner:"ldap process"});a.set(["us","ern","ame"].join(""),null===(t=this.uname)||void 0===t?void 0:t.value),a.set(["p","ass","word"].join(""),null===(o=this.mima)||void 0===o?void 0:o.value),this.httpClient.post(`${v.N.apiUrl}/dgrv4/ssotoken/acidp/${this.idpType}/acIdPLogin`,a,{headers:i,responseType:"text",observe:"response"}).subscribe(h=>{this.sanitizerService.navigateUrl(h.url)})}setFuncList(){return new Z.y(t=>{this.funcService.queryAllFunc().subscribe(o=>{this.toolService.checkDpSuccess(o.ResHeader)&&(this.toolService.setFuncList(o.RespBody.funcList),t.next(!0))})})}auth(t){let o=[];return new Z.y(a=>{this.userService.queryFuncByLoginUser().subscribe(i=>{if(this.toolService.checkDpSuccess(i.ResHeader)){this.toolService.writeRoleFuncCodeList(i.RespBody.funcCodeList);for(let c=0;c<t.length;c++){const u=t[c];let h=i.RespBody.funcCodeList.findIndex(d=>d===u);o.findIndex(d=>d.funCode==u)<0?o.push({funCode:u,canExecute:h>=0}):h>=0&&(o[o.findIndex(d=>d.funCode==u)].canExecute=!0)}a.next(o)}})})}get uname(){return this.form.get("uname")}get mima(){return this.form.get("mima")}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(r.qu),e.Y36(l.eN),e.Y36(S.g),e.Y36(U.c),e.Y36(T.T),e.Y36(b.f),e.Y36(C.K),e.Y36(y.F0),e.Y36(x.LA),e.Y36(Y.B),e.Y36(y.gz),e.Y36(p.Y))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-ldap"]],features:[e._Bn([p.Y])],decls:42,vars:29,consts:[[1,"login-center-page"],[1,"form-wrapper"],[3,"formGroup","ngSubmit"],[1,"form-header"],[2,"font-weight","bold"],[3,"src"],[1,"form-body"],[1,"line",3,"hidden"],[2,"font-size","small"],[1,"form-area"],[1,"input-line"],["for","uname"],[1,"input-sign-wrapper"],[1,"sign"],["src","assets/images/login/i_user.png","alt","number"],["type","text","formControlName","uname",1,"form-control",3,"placeholder"],["username",""],["src","assets/images/login/i_pwd.png","alt","number"],["type","password","formControlName","mima",1,"form-control",3,"placeholder"],[1,"btn-row"],["type","submit",1,"btn","btn-login"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"form",2),e.NdJ("ngSubmit",function(){return o.submitForm()}),e.TgZ(3,"div",3)(4,"h1",4),e._UZ(5,"img",5),e.ALo(6,"safeUrl"),e._uU(7),e.qZA()(),e._UZ(8,"hr"),e.TgZ(9,"div",6)(10,"div",7)(11,"p"),e._uU(12),e.ALo(13,"translate"),e.ALo(14,"translate"),e.qZA(),e.TgZ(15,"p",8),e._uU(16),e.ALo(17,"translate"),e.qZA()(),e.TgZ(18,"div",9)(19,"div",10)(20,"label",11),e._uU(21),e.ALo(22,"translate"),e.qZA(),e.TgZ(23,"div",12)(24,"span",13),e._UZ(25,"img",14),e.qZA(),e._UZ(26,"input",15,16),e.ALo(28,"translate"),e.qZA()(),e.TgZ(29,"div",10)(30,"label",11),e._uU(31),e.ALo(32,"translate"),e.qZA(),e.TgZ(33,"div",12)(34,"span",13),e._UZ(35,"img",17),e.qZA(),e._UZ(36,"input",18),e.ALo(37,"translate"),e.qZA()(),e.TgZ(38,"div",19)(39,"button",20),e._uU(40),e.ALo(41,"translate"),e.qZA()()()()()()()),2&t&&(e.xp6(2),e.Q6J("formGroup",o.form),e.xp6(3),e.Q6J("src",e.lcZ(6,11,o.imgSrc),e.LSH),e.xp6(2),e.hij(" ",o.title," "),e.xp6(3),e.Q6J("hidden","API"==o.idpType),e.xp6(2),e.hij(" ","LDAP"==o.idpType?e.lcZ(13,13,"adldap_login"):e.lcZ(14,15,"m_adldap_login")," "),e.xp6(4),e.hij(" ",e.lcZ(17,17,"continue_proc")," "),e.xp6(5),e.Oqu(e.lcZ(22,19,"user_name")),e.xp6(5),e.Q6J("placeholder",e.lcZ(28,21,"user_name")),e.xp6(5),e.Oqu(e.lcZ(32,23,"user_password")),e.xp6(5),e.Q6J("placeholder",e.lcZ(37,25,"user_password")),e.xp6(4),e.hij(" ",e.lcZ(41,27,"login")," "))},directives:[r._Y,r.JL,r.sg,r.Fj,r.JJ,r.u],pipes:[M.Q,B.X$],styles:[""]}),n})()}];let I=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[y.Bz.forChild(F)],y.Bz]}),n})(),P=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[L.ez,r.u5,r.UX,f.m,I]]}),n})()},72129:(A,g,s)=>{s.d(g,{Q:()=>L});var f=s(87587),r=s(22313);let L=(()=>{class p{constructor(l){this.sanitizer=l}transform(l){return l?this.sanitizer.bypassSecurityTrustUrl(l):""}}return p.\u0275fac=function(l){return new(l||p)(f.Y36(r.H7,16))},p.\u0275pipe=f.Yjl({name:"safeUrl",type:p,pure:!0}),p})()}}]);